profiles {
  alvis {
    workDir = '/cephyr/users/yunqi/Alvis/proj/pils_data/work'

    params{
      cp2k_cmd = 'OMP_NUM_THREADS=2 mpirun -n 4 cp2k.psmp'
    }

    executor{
      name = 'slurm'
      queueSize = 100
      submitRateLimit = '120 min'
    }

    process {
      time = '3d'
      executor = 'slurm'
      errorStrategy='ignore'

      withLabel: 'molutils' {executor='local'}
      withLabel: 'pinn' {scratch=true}
      withLabel: 'tips|pinn|ase' {
        beforeScript = 'source $HOME/pinet2-tf26/bin/activate'
        module = 'TensorFlow/2.6.0-foss-2021a-CUDA-11.3.1'
        clusterOptions = '--gres=gpu:T4:1'
      }
      withLabel: 'cp2k' {
        scratch=true
        clusterOptions = '-n 8 --gres=gpu:T4:2 -A NAISS2023-5-282'
        container='/cephyr/users/yunqi/Alvis/proj/cp2k_v9.1.0.sif'
      }
    }

    singularity {
      enabled = true
      runOptions = '--nv'
    }
  }
}
